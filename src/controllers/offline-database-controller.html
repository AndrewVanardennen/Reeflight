<link rel="import" href="pouch-controller.html">
<link rel="import" href="../mixins/database-offline-mixin.html">

<script>
'use strict';
import Backed from './../../node_modules/backed/dist/backed-es.js';
// import PubSub from './../internals/pubsub.js';
// window.pubsub = window.pubsub || new PubSub();
/**
 * @extends PouchController
 */
window.OfflineDatabaseController = Backed(class OfflineDatabaseController extends DatabaseOfflineMixin(PouchController) {
  static get observedAttributes() {
    return ['database'];
  }

  // static get properties() {
  // 	return {
  // 		userOnline: {
  // 			value: false,
  // 			observer: '_onUserLogin',
  // 			global: true,
  // 			strict: false
  // 		}
  // 	};
  // }
  attributeChangedCallback(name, oldValue, newValue) {
    if (oldValue !== newValue) {
      this[this.toJsProp(name)] = newValue;
    }
  }
  set database(value) {
    this._database = value;
    // this._pouchdbReady();
  }
  get database() {
    return this._database;
  }
  _pouchdbReady() {
    if (this.database && this.pouchReady) {
      this.pouch = new PouchDB(this.database);
      pubsub.publish(`database.${this.database}.ready`, true);
    }
  }
});

</script>
