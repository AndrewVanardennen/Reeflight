<script>
'use strict';
export default Backed(class PouchController extends HTMLElement {
	created() {
		this._importPouchdb = this._importPouchdb.bind(this);
		this._onLoad = this._onLoad.bind(this);
	}
	static get properties() {
		return {
			pouchReady: {
				value: false,
				observer: 'pouchdbReady',
				global: true
			}
		};
	}
	/**
	 * @private
	 */
	ready() {
		requestIdleCallback(this._importPouchdb);
	}
	/**
	 * @private
	 */
	_importPouchdb() {
		if (window.PouchDB !== undefined) {
			this.pouchReady = true;
			// return;
		} else {
			const script = document.createElement('script');
			script.src = 'https://cdn.jsdelivr.net/pouchdb/6.1.0/pouchdb.min.js';
			script.setAttribute('async', '');
			script.onload = this._onLoad;
				// TODO: Fork PouchDB & run rollup on it
			this.appendChild(script);
		}
	}

	_onLoad() {
		this.pouchReady = true;
	}
});
</script>
